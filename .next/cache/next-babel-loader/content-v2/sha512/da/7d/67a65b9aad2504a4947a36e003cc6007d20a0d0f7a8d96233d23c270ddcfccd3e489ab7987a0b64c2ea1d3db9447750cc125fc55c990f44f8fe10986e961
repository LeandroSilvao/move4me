{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { createContext, useState } from \"react\";\nimport { useRouter } from 'next/router';\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\nimport config from '../config';\nexport const UserContext = /*#__PURE__*/createContext({});\nexport const UserProvider = props => {\n  const {\n    0: username,\n    1: setUsername\n  } = useState(\"\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"\");\n  const {\n    0: fullName,\n    1: setFullName\n  } = useState(\"\");\n  const {\n    0: urlProfilePicture,\n    1: setUrlProfilePicture\n  } = useState(\"\");\n  const {\n    0: authenticated,\n    1: setAuthenticated\n  } = useState(false);\n  const {\n    0: googleAuthenticated,\n    1: setGoogleAuthenticated\n  } = useState(false);\n  const {\n    0: accessToken,\n    1: setAccessToken\n  } = useState('');\n  const router = useRouter();\n\n  function ClearUserInfo() {\n    setUsername('');\n    setPassword('');\n    setFullName('');\n    setAuthenticated(false);\n    setGoogleAuthenticated(false);\n    setAccessToken('');\n    setUrlProfilePicture('');\n    Cookies.set('accessToken', '');\n  }\n\n  function setUser(e) {\n    const username = e.target.value;\n    setUsername(username);\n  }\n\n  function setUserPassword(e) {\n    const password = e.target.value;\n    setPassword(password);\n  }\n\n  function SignIn() {\n    axios.post(`/api/auth?grant_type=password&username=${username}&password=${password}`).then(res => {\n      if (res.data.access_token) {\n        setAccessToken(res.data.access_token);\n        setAuthenticated(true);\n        axios.get(`${config.urlGitLabUserInfo}${username}`).then(res => {\n          setFullName(res.data[0].name);\n          const urlProfilePicture = res.data[0].avatar_url.replace('10.10.1.35', '177.84.246.126:9955');\n          setUrlProfilePicture(urlProfilePicture);\n        });\n        router.push('/home');\n      }\n    }).catch(err => console.log(err));\n  }\n\n  function SearchUserDetails(token) {\n    axios.get(`${config.urlUserIngoGoogle}${token}`).then(res => {\n      const {\n        picture,\n        given_name\n      } = res.data;\n      setUrlProfilePicture(picture);\n      setFullName(given_name);\n      setUsername(res.data.email.split(\"@\")[0]);\n    });\n  }\n\n  function SignInGoogle({\n    accessToken\n  }) {\n    Cookies.set('accessToken', accessToken);\n    setAccessToken(accessToken);\n    setGoogleAuthenticated(true);\n    SearchUserDetails(accessToken);\n    router.push('/home');\n  }\n\n  function SignOut() {\n    router.push('/');\n    ClearUserInfo();\n  }\n\n  return /*#__PURE__*/_jsx(UserContext.Provider, {\n    value: {\n      username,\n      setUser,\n      password,\n      setUserPassword,\n      fullName,\n      urlProfilePicture,\n      SignIn,\n      SignInGoogle,\n      SearchUserDetails,\n      SignOut,\n      ClearUserInfo\n    },\n    children: props.children\n  });\n};","map":null,"metadata":{},"sourceType":"module"}
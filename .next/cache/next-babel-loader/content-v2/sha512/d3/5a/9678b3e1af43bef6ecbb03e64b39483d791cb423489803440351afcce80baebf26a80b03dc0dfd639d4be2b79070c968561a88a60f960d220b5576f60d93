{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\Desktop\\\\Solve\\\\TREINAMENTOS\\\\NLW\\\\#4\\\\moveit-next\\\\src\\\\contexts\\\\LoginContexts.tsx\";\nimport { createContext, useState } from \"react\";\nimport { useRouter } from 'next/router';\nimport axios from \"axios\";\nexport const UserContext = /*#__PURE__*/createContext({});\nexport const UserProvider = props => {\n  const {\n    0: username,\n    1: setUsername\n  } = useState(\"\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"\");\n  const {\n    0: fullName,\n    1: setFullName\n  } = useState(\"\");\n  const {\n    0: urlProfilePicture,\n    1: setUrlProfilePicture\n  } = useState(\"\");\n  const {\n    0: authenticated,\n    1: setAuthenticated\n  } = useState(false);\n  const {\n    0: googleAuthenticated,\n    1: setGoogleAuthenticated\n  } = useState(false);\n  const {\n    0: accessToken,\n    1: setAccessToken\n  } = useState('');\n  const router = useRouter();\n\n  function setUser(e) {\n    const username = e.target.value;\n    setUsername(username);\n  }\n\n  function setUserPassword(e) {\n    const password = e.target.value;\n    setPassword(password);\n  }\n\n  function SignIn() {\n    axios.post(`/api/auth?grant_type=password&username=${username}&password=${password}`).then(res => {\n      if (res.data.access_token) {\n        setAccessToken(res.data.access_token);\n        setAuthenticated(true);\n        axios.get(`https://gitlab.com/api/v4/users?username=${username}`).then(res => {\n          setFullName(res.data[0].name);\n          const urlProfilePicture = res.data[0].avatar_url.replace('10.10.1.35', '177.84.246.126:9955');\n          setUrlProfilePicture(urlProfilePicture);\n        });\n        router.push('/home');\n      }\n    }).catch(err => console.log(err));\n  }\n\n  function SignInGoogle({\n    accessToken\n  }) {\n    axios.get(`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${accessToken}`).then(res => {\n      const {\n        picture,\n        given_name\n      } = res.data;\n      setAccessToken(accessToken);\n      setGoogleAuthenticated(true);\n      setUsername(res.data.email.split(\"@\")[0]);\n      setUrlProfilePicture(picture);\n      setFullName(given_name);\n    }).then(() => router.push('/home'));\n  }\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      username,\n      setUser,\n      password,\n      setUserPassword,\n      fullName,\n      urlProfilePicture,\n      SignIn,\n      SignInGoogle\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};","map":{"version":3,"sources":["D:/Desktop/Solve/TREINAMENTOS/NLW/#4/moveit-next/src/contexts/LoginContexts.tsx"],"names":["createContext","useState","useRouter","axios","UserContext","UserProvider","props","username","setUsername","password","setPassword","fullName","setFullName","urlProfilePicture","setUrlProfilePicture","authenticated","setAuthenticated","googleAuthenticated","setGoogleAuthenticated","accessToken","setAccessToken","router","setUser","e","target","value","setUserPassword","SignIn","post","then","res","data","access_token","get","name","avatar_url","replace","push","catch","err","console","log","SignInGoogle","picture","given_name","email","split","children"],"mappings":"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","sourcesContent":["import { createContext, ReactNode, useEffect, useState } from \"react\";\r\nimport { useRouter } from 'next/router'\r\nimport axios from \"axios\";\r\nimport { route } from \"next/dist/next-server/server/router\";\r\n\r\ninterface UserContextData {\r\n  username: string;\r\n  password: string;\r\n  fullName: string;\r\n  urlProfilePicture: string;\r\n  setUser: (e) => void;\r\n  setUserPassword: (e) => void;\r\n  SignIn: () => void;\r\n  SignInGoogle: (res) => void;\r\n}\r\nexport const UserContext = createContext({} as UserContextData);\r\n\r\nexport const UserProvider: React.FC = (props) => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [fullName, setFullName] = useState(\"\");\r\n  const [urlProfilePicture, setUrlProfilePicture] = useState(\"\");\r\n  const [authenticated, setAuthenticated] = useState(false);\r\n  const [googleAuthenticated, setGoogleAuthenticated] = useState(false);\r\n  const [accessToken, setAccessToken] = useState('');\r\n  const router = useRouter()\r\n\r\n  function setUser(e) {\r\n    const username = e.target.value;\r\n    setUsername(username);\r\n  }\r\n  function setUserPassword(e) {\r\n    const password = e.target.value;\r\n    setPassword(password);\r\n  }\r\n  function SignIn() {\r\n    axios\r\n      .post(\r\n        `/api/auth?grant_type=password&username=${username}&password=${password}`\r\n      )\r\n      .then((res) => {\r\n        if (res.data.access_token) {\r\n          setAccessToken(res.data.access_token)\r\n          setAuthenticated(true);\r\n\r\n          axios.get(`https://gitlab.com/api/v4/users?username=${username}`)\r\n          .then(res => {\r\n            setFullName(res.data[0].name)\r\n            const urlProfilePicture = res.data[0].avatar_url.replace('10.10.1.35','177.84.246.126:9955')\r\n            setUrlProfilePicture(urlProfilePicture)\r\n          })\r\n          router.push('/home')\r\n        }\r\n      })\r\n      .catch((err) => console.log(err));\r\n  }\r\n  function SignInGoogle({accessToken}){\r\n    axios.get(`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${accessToken}`)\r\n    .then(res => {\r\n      const {picture, given_name} = res.data\r\n\r\n      setAccessToken(accessToken)\r\n      setGoogleAuthenticated(true)\r\n      setUsername(res.data.email.split(\"@\")[0])\r\n      setUrlProfilePicture(picture)\r\n      setFullName(given_name)\r\n    })\r\n    .then(() => router.push('/home'))\r\n  }\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{\r\n        username,\r\n        setUser,\r\n        password,\r\n        setUserPassword,\r\n        fullName,\r\n        urlProfilePicture,\r\n        SignIn,\r\n        SignInGoogle\r\n      }}\r\n    >\r\n      {props.children}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}